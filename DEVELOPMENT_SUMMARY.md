# Star Tracer - 개발 완료 요약

## 📊 프로젝트 개요

**프로젝트명**: Star Tracer (스타 트레이서)
**플랫폼**: Android (Flutter)
**개발 기간**: 2025년
**버전**: 1.0.0

## 🎯 핵심 컨셉

사용자의 '시선'을 컨트롤러로 사용하여, 화면에 제시된 별자리 트랙을 따라가는 혁신적인 웰니스 게임입니다. 부드러운 안구 운동(Smooth Pursuit)을 유도하여 눈 피로도 감소 및 집중력 강화를 목표로 합니다.

---

## ✅ 완료된 마일스톤

### Milestone 1: MVP (완료)
**목표**: 시선 추적 기반 단일 트랙 게임 플레이 가능

#### 주요 구현 내용
1. **Flutter 프로젝트 초기화**
   - pubspec.yaml 의존성 설정
   - Android 네이티브 설정
   - 프로젝트 구조 설계

2. **시선 추적 시스템**
   - ML Kit Face Detection 통합
   - 9포인트 캘리브레이션
   - 실시간 시선 좌표 추적
   - 시선 데이터 스무딩 처리

3. **게임 코어 메커니즘**
   - Canvas 기반 트랙 렌더링
   - Track 모델 (경로 데이터, 진행도 계산)
   - 시선-트랙 충돌 감지 알고리즘
   - 정확도 측정 시스템

4. **화면 구현**
   - Splash Screen (로딩 화면)
   - Home Screen (메인 메뉴)
   - Calibration Screen (9포인트 캘리브레이션)
   - Game Screen (실제 게임 플레이)
   - Result Screen (게임 결과 및 등급)
   - Settings Screen (설정)

5. **상태 관리**
   - Provider 패턴
   - EyeTrackingProvider (시선 추적)
   - GameProvider (게임 상태)

6. **로컬 저장**
   - SharedPreferences
   - 최고 기록 저장 (상위 10개)

---

### Milestone 2: 게임성 강화 (완료)
**목표**: 페널티/보상, 콤보, 피버 모드, 난이도 시스템 추가

#### 주요 구현 내용
1. **다양한 트랙 시스템 (15개)**
   - **초급 5개**: 별빛 산책, 달빛 곡선, 반딧불 길, 유성우, 행성 궤도
   - **중급 5개**: 은하수 항로, 소용돌이 성운, 천둥 번개, 무한 루프, 카시오페이아
   - **고급 5개**: 블랙홀 회전, DNA 이중나선, 초신성 폭발, 드래곤의 비행, 오각 별

2. **TrackRepository**
   - 특수 경로 생성 함수
     - 원형 경로 (원 궤도)
     - 나선형 경로 (소용돌이)
     - 무한대 경로 (∞)
     - 이중나선 경로 (DNA)
     - 별 모양 경로 (펜타그램)

3. **트랙 선택 UI**
   - 난이도별 트랙 리스트
   - 트랙 미리보기 (CustomPainter)
   - 난이도 변경 다이얼로그

4. **사운드 및 진동 시스템**
   - **AudioService 구현**
     - 사운드 효과 7종 (트랙 유지/이탈, 콤보, 피버, 완료, 클릭)
     - BGM 3종 (메뉴, 게임, 피버)
     - 진동 피드백 4종
   - **GameProvider 통합**
     - 페널티 시 경고음 + 진동
     - 콤보 5배수마다 사운드
     - 피버 모드 음악 전환

5. **페널티 & 보상 시스템**
   - 트랙 이탈: 속도 감소, 콤보/게이지 초기화, 정확도 감소
   - 트랙 유지: 콤보 증가, 피버 게이지 충전, 점수 획득

6. **콤보 & 피버 모드**
   - 연속 성공 시 콤보 스택
   - 게이지 100% 충전 시 피버 발동
   - 피버 모드: 속도 1.5배, 점수 2배, 특수 이펙트

---

### Milestone 3: 콘텐츠 확장 (완료)
**목표**: 소셜 공유, 설정 시스템, UX 개선

#### 주요 구현 내용
1. **소셜 공유 기능**
   - **ShareService 구현**
     - 게임 결과 공유 (등급, 점수, 정확도, 콤보, 시간)
     - 리더보드 공유
     - 친구 초대 공유
   - 등급별 이모지 (S: 🏆, A: 🥇, B: 🥈, C: 🥉)
   - 결과 화면에 공유 버튼 추가

2. **설정 시스템**
   - **SettingsService 구현**
     - 사운드 효과 ON/OFF
     - 배경 음악 ON/OFF
     - 진동 ON/OFF
     - SharedPreferences로 설정 영구 저장
   - **설정 화면 완성**
     - StatefulWidget으로 실시간 상태 관리
     - AudioService와 즉시 연동
     - 시선 추적 캘리브레이션 초기화
     - 개발자 정보, 라이선스 표시

3. **오디오 시스템 개선**
   - 모든 사운드/음악 함수에 안전한 에러 처리
   - 파일 없을 때도 앱 크래시 방지
   - 더미 사운드 파일 10개 추가

---

## 📦 기술 스택

### Frontend
- **Flutter 3.0+**: 크로스 플랫폼 프레임워크
- **Dart 3.0+**: 프로그래밍 언어

### 시선 추적
- **ML Kit Face Detection**: Google ML Kit 얼굴 및 눈 랜드마크 감지
- **Camera Plugin**: 카메라 접근 및 이미지 스트림 처리

### 상태 관리
- **Provider**: 앱 전역 상태 관리

### 로컬 저장
- **SharedPreferences**: 게임 기록 및 설정 저장

### 그래픽
- **CustomPainter**: Canvas 기반 트랙 렌더링
- **Animations**: Flutter 애니메이션 시스템

### 오디오 & 햅틱
- **audioplayers**: 사운드 효과 및 BGM
- **vibration**: 진동 피드백

### 공유
- **share_plus**: 소셜 공유 기능

---

## 📁 프로젝트 구조

```
star_tracer/
├── lib/
│   ├── main.dart                          # 앱 진입점
│   ├── models/                            # 데이터 모델
│   │   ├── game_state.dart                # 게임 상태 enum
│   │   ├── track.dart                     # 트랙 모델
│   │   └── game_result.dart               # 게임 결과 모델
│   ├── providers/                         # 상태 관리
│   │   ├── eye_tracking_provider.dart     # 시선 추적
│   │   └── game_provider.dart             # 게임 상태
│   ├── screens/                           # 화면
│   │   ├── splash_screen.dart             # 스플래시
│   │   ├── home_screen.dart               # 홈
│   │   ├── track_selection_screen.dart    # 트랙 선택
│   │   ├── calibration_screen.dart        # 캘리브레이션
│   │   ├── game_screen.dart               # 게임
│   │   ├── result_screen.dart             # 결과
│   │   └── settings_screen.dart           # 설정
│   ├── widgets/                           # 재사용 위젯
│   │   ├── track_painter.dart             # 트랙 렌더링
│   │   └── game_hud.dart                  # 게임 HUD
│   └── services/                          # 비즈니스 로직
│       ├── track_repository.dart          # 트랙 관리
│       ├── audio_service.dart             # 오디오 관리
│       ├── settings_service.dart          # 설정 관리
│       └── share_service.dart             # 공유 기능
├── android/                               # Android 네이티브
├── assets/                                # 에셋
│   ├── sounds/                            # 사운드 파일 (더미)
│   └── images/                            # 이미지
├── pubspec.yaml                           # 의존성 관리
├── README.md                              # 프로젝트 문서
└── DEVELOPMENT_SUMMARY.md                 # 개발 요약 (이 파일)
```

---

## 📊 개발 통계

### 코드 라인 수
- **총 파일 수**: 60+ 파일
- **총 코드 라인**: 약 5,000+ 줄
- **커밋 수**: 3개 주요 커밋 (Milestone 1, 2, 3)

### 주요 파일
- **Providers**: 2개 (EyeTrackingProvider, GameProvider)
- **Screens**: 7개
- **Models**: 3개
- **Services**: 4개
- **Widgets**: 2개
- **트랙**: 15개 (초급 5, 중급 5, 고급 5)

---

## 🎮 게임 플레이 플로우

```
1. 앱 시작 (Splash)
   ↓
2. 홈 화면
   ├─ 게임 시작
   ├─ 난이도 선택
   ├─ 테마 선택
   ├─ 기록 보기
   └─ 설정
   ↓
3. 트랙 선택
   ├─ 난이도별 트랙 리스트
   └─ 트랙 미리보기
   ↓
4. 캘리브레이션 (필요 시)
   └─ 9포인트 응시
   ↓
5. 게임 플레이
   ├─ 시선으로 트랙 따라가기
   ├─ 콤보 & 피버 모드
   ├─ 사운드 & 진동 피드백
   └─ 진행도 및 점수 표시
   ↓
6. 게임 종료
   ├─ 결과 화면 (등급, 점수, 정확도)
   ├─ 다시하기
   ├─ 공유하기
   └─ 메인 메뉴
```

---

## 🎨 주요 기능 상세

### 1. 시선 추적 시스템
- **ML Kit Face Detection** 사용
- 얼굴 및 눈 랜드마크 실시간 감지
- 9포인트 캘리브레이션으로 정확도 향상
- 5개 포인트 버퍼로 스무딩 처리

### 2. 트랙 시스템
- **15개의 다양한 트랙**
  - 난이도별 트랙 폭, 속도 조절
  - 특수 경로 생성 알고리즘
- **트랙 데이터 구조**
  - 포인트 리스트 (Offset)
  - 총 길이 계산
  - 진행도에 따른 위치 계산
  - 충돌 감지 (점-선분 거리 계산)

### 3. 게임 메커니즘
- **페널티 시스템**
  - 속도 50% 감소
  - 콤보/피버 초기화
  - 정확도 5% 감소
  - 경고음 + 진동 (200ms)

- **보상 시스템**
  - 콤보 증가 (연속 유지)
  - 피버 게이지 충전 (+1%)
  - 점수 획득 (기본 10점, 피버 시 2배)
  - 5콤보마다 사운드 + 진동

- **피버 모드**
  - 게이지 100% 충전 시 자동 발동
  - 10초간 지속
  - 속도 1.5배, 점수 2배
  - 특수 BGM 및 화려한 이펙트

### 4. 사운드 & 진동
- **사운드 효과** (7종)
  - 트랙 유지, 이탈
  - 콤보 증가
  - 피버 시작/종료
  - 게임 완료
  - 버튼 클릭

- **배경 음악** (3종)
  - 메뉴 BGM
  - 게임 BGM
  - 피버 BGM (자동 전환)

- **진동 피드백** (4종)
  - 트랙 이탈 (단일, 200ms)
  - 콤보 (짧은, 100ms)
  - 피버 시작 (패턴)
  - 게임 완료 (축하 패턴)

### 5. 소셜 공유
- **게임 결과 공유**
  - 등급, 점수, 정확도, 콤보, 시간
  - 난이도, 테마 정보
  - 등급별 이모지 포함

- **리더보드 공유**
  - 상위 10개 기록
  - 메달 이모지 (1st: 🥇, 2nd: 🥈, 3rd: 🥉)

- **친구 초대**
  - 게임 소개 텍스트
  - 해시태그 포함

### 6. 설정
- **게임 설정**
  - 사운드 효과 ON/OFF
  - 배경 음악 ON/OFF
  - 진동 ON/OFF
  - SharedPreferences로 저장

- **시선 추적**
  - 캘리브레이션 초기화

- **정보**
  - 버전 정보
  - 오픈소스 라이선스
  - 개발자 정보

---

## 🚀 설치 및 실행

### 사전 요구사항
```bash
# Flutter SDK 설치 (3.0 이상)
# https://docs.flutter.dev/get-started/install

# Android Studio 또는 VS Code
# Android SDK 및 에뮬레이터
```

### 설치
```bash
cd /home/user/eyetracking
flutter pub get
```

### 실행
```bash
# 디바이스 연결 확인
flutter devices

# 앱 실행
flutter run
```

### 빌드
```bash
# APK 빌드
flutter build apk --release

# App Bundle 빌드 (Play Store용)
flutter build appbundle --release
```

---

## ⚠️ 중요 참고사항

### 1. 사운드 파일
현재 `assets/sounds/` 디렉토리에는 **더미 파일**만 있습니다.
실제 게임을 플레이하려면 다음 사운드 파일을 추가해야 합니다:

```
assets/sounds/
├── on_track.mp3          # 트랙 유지 사운드
├── off_track.mp3         # 트랙 이탈 경고음
├── combo.mp3             # 콤보 증가 사운드
├── fever_start.mp3       # 피버 모드 시작
├── fever_end.mp3         # 피버 모드 종료
├── game_complete.mp3     # 게임 완료
├── click.mp3             # 버튼 클릭
├── menu_bgm.mp3          # 메뉴 배경음악
├── game_bgm.mp3          # 게임 배경음악
└── fever_bgm.mp3         # 피버 모드 음악
```

**파일이 없어도 앱은 정상 작동하지만, 소리가 나지 않습니다.**

### 2. 시선 추적 정확도
- 밝은 조명 환경에서 사용 권장
- 카메라와 적절한 거리 유지 (30~50cm)
- 고개를 움직이지 말고 눈만 움직이기
- 필요 시 캘리브레이션 재실행

### 3. 성능
- 중급 이상 스펙의 Android 디바이스 권장
- API 21 (Android 5.0) 이상
- 최소 2GB RAM

---

## 🐛 알려진 이슈

1. **시선 추적 정확도**
   - 조명 환경에 크게 영향받음
   - 캘리브레이션 알고리즘 개선 필요

2. **성능**
   - 저사양 디바이스에서 프레임 드롭 가능
   - 트랙 렌더링 최적화 필요

3. **사운드**
   - 실제 오디오 에셋 필요
   - 현재는 더미 파일만 포함

4. **멀티플랫폼**
   - 현재 Android만 지원
   - iOS 빌드는 추가 작업 필요

---

## 📝 향후 계획 (Milestone 4)

### 백엔드 연동
- Firebase 또는 Supabase
- 실시간 데이터베이스
- 사용자 인증

### 글로벌 리더보드
- 전세계 랭킹 시스템
- 친구 기록 비교
- 주간/월간 챌린지

### 멀티플레이
- 2인 협동 모드
- 실시간 동기화 (WebSocket)
- 협동 미션

### AI 트레이닝
- 맞춤형 눈 운동 루틴
- 일일 트레이닝 추천
- 진행도 트래킹

### 수익화
- 광고 통합 (AdMob)
- 프리미엄 테마 인앱 구매
- 시즌 패스

### 콘텐츠
- 실제 사운드 에셋 제작
- 테마별 비주얼 강화
- 더 많은 트랙 추가 (30+)

---

## 🏆 완성도

### 현재 상태
- ✅ **MVP 완료** (100%)
- ✅ **게임성 강화 완료** (100%)
- ✅ **콘텐츠 확장 완료** (100%)
- ⏸️ **고급 기능** (0% - 향후 계획)

### 전체 완성도
**약 75%** (Milestone 1~3 완료, Milestone 4는 향후 계획)

---

## 👥 개발자 정보

**개발자**: GenSpark AI Developer
**프로젝트 시작**: 2025년
**라이선스**: MIT License

---

## 📞 문의

이슈 및 PR을 환영합니다!

GitHub: [Repository URL]

---

**즐거운 게임 되세요! 👁️✨**
